<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/template/template.xhtml">

        <ui:define name="body">
        	<h:form id="ConfiguracionFacturaListForm" enctype="multipart/form-data" method="post"
            	onkeyup="if (event.keyCode == 13) { return false; }"
				onkeypress="if (event.keyCode == 13) { return false; }">
	            <p:layout>
		            <p:layoutUnit id="westLayout" position="west" size="150" >	
		            	<h:outputText value="Datos de la Empresa" style="font-weight:bold;"/>
		            </p:layoutUnit>
		            <p:layoutUnit position="center" header="Datos de la empresa" style="height:480px;">
			            <h:panelGroup id="display">
			                <p:tabView>
			                
				                <p:tab id="facturacion" title="RazÃ³n Social">
				                    <p:panelGrid columns="2" >
				                    	<p:column>
				                    	<h:form prependId="true" enctype="multipart/form-data" method="post">
				                    		<p:fileUpload
							                	label="#{msg['catalogo.Button.Logo.Buscar']}"
							                	uploadLabel="#{msg['catalogo.Button.Logo.Upload']}"
							                	cancelLabel="#{msg['catalogo.Button.Producto.Cancelar']}"  	                	       	
							                	fileLimitMessage="#{msg['catalogo.Producto.FileLimitMessage']}"
							                	invalidFileMessage="#{msg['catalogo.Producto.InvalidFileMessage']}"
							                	invalidSizeMessage="#{msg['catalogo.Producto.InvalidSizeMessage']}"
							                	
							                	value="#{configuracionFacturacionBean.file}" 
							                	previewWidth="80"
							                	mode="advanced"
							                	
							                	allowTypes="/(\.|\/)(gif|jpe?g|png)$/"
							                	fileLimit="99"
							                	sizeLimit="2000000"
							                	update="@parent:@parent:panelImagen"
							                	fileUploadListener="#{configuracionFacturacionBean.fileUploadListener}">
							                </p:fileUpload>
							            </h:form>
				                    	</p:column>
				                    	<p:column>
				                    		<p:panelGrid id="panelImagen" layout="grid" columns="1" >                	
												<h:graphicImage id="imagenlogo" value="data:image/png;base64,#{configuracionFacturacionBean.imagenB64}" width="200"/>                	
						                        <p:outputLabel
						                        	styleClass="boldLabel"
						                        	value="#{msg['catalogo.Label.ImagenSeleccionada']}"
						                        	for="filename" />
							                    <p:outputLabel
							                    	id="filename"
							                    	value="#{configuracionFacturacionBean.currentFilenameImage}"/>	                    
						                    </p:panelGrid>
				                    	</p:column>
				                    	
				                        <p:outputLabel 
				                        	value="#{msg['catalogo.Label.Rfc']}"
				                        	for="rfc" />
				                        <p:inputText 
				                        	id="rfc" 
				                        	value="#{configuracionFacturacionBean.selected.rfc}" 
				                        	title="#{msg['catalogo.Label.Rfc']}"
				                        	required="true" />
				                        	
				                        <p:outputLabel                         	
				                        	value="#{msg['catalogo.Label.RazonSocial']}"
				                        	for="razonsocial" />
				                        <p:inputText 
				                        	id="razonsocial" 
				                        	value="#{configuracionFacturacionBean.selected.razonsocial}" 
				                        	title="#{msg['catalogo.Label.RazonSocial']}"
				                        	required="true" />
				                        	
				                        <p:outputLabel                         	
				                        	value="#{msg['catalogo.Label.RegimenFiscal']}"
				                        	for="regimenFiscal" />
				                        <p:inputText 
				                        	id="regimenFiscal" 
				                        	value="#{configuracionFacturacionBean.selected.regimenFiscal}" 
				                        	title="#{msg['catalogo.Label.RegimenFiscal']}"
				                        	required="true" />
				                        
				                        <p:outputLabel                         	
				                        	value="#{msg['catalogo.Label.CertificadoSelloDigital']}"
				                        	for="csd" />
				                        <p:column id="columnaCer">	
					                        	<p:fileUpload 
					                        		id="csd"
								                	label="Seleccionar archivo .Cer"
								                	uploadLabel="#{msg['catalogo.Button.Logo.Upload']}"
								                	cancelLabel="#{msg['catalogo.Button.Producto.Cancelar']}"  	                	       	
								                	fileLimitMessage="#{msg['catalogo.Producto.FileLimitMessage']}"
								                	invalidFileMessage="#{msg['catalogo.ConfiguracionFactura.InvalidFileMessage.Csd']}"
								                	invalidSizeMessage="#{msg['catalogo.Producto.InvalidSizeMessage']}"
								                	auto="true"
								                	value="#{configuracionFacturacionBean.csdFile}" 
								                	previewWidth="80"
								                	mode="advanced"
								                	
								                	allowTypes="/(\.|\/)(cer|Cer|CER)$/"
								                	fileLimit="99"
								                	sizeLimit="2000000"
								                	update="@parent:csdName"
								                	fileUploadListener="#{configuracionFacturacionBean.csdUploadListener}">
								                </p:fileUpload>
								                <p:outputLabel
								                    	id="csdName"
								                    	value="#{configuracionFacturacionBean.csdName}"/>
							                </p:column>
							                
							                <p:outputLabel                         	
					                        	value="#{msg['catalogo.Label.Key']}"
					                        	for="key" />
					                        <p:column>
					                        	<p:fileUpload 
					                        		id="key"
								                	label="Seleccionar Archivo .key"
								                	uploadLabel="#{msg['catalogo.Button.Logo.Upload']}"
								                	cancelLabel="#{msg['catalogo.Button.Producto.Cancelar']}"  	                	       	
								                	fileLimitMessage="#{msg['catalogo.Producto.FileLimitMessage']}"
								                	invalidFileMessage="#{msg['catalogo.ConfiguracionFactura.InvalidFileMessage.Key']}"
								                	invalidSizeMessage="#{msg['catalogo.Producto.InvalidSizeMessage']}"
								                	auto="true"
								                	value="#{configuracionFacturacionBean.keyFile}" 
								                	previewWidth="80"
								                	mode="advanced"
								                	
								                	allowTypes="/(\.|\/)(key|Key|KEY)$/"
								                	fileLimit="99"
								                	sizeLimit="2000000"
								                	update="@parent:keyName"
								                	fileUploadListener="#{configuracionFacturacionBean.keyUploadListener}">
								                </p:fileUpload>
								                <p:outputLabel
							                    	id="keyName"
							                    	value="#{configuracionFacturacionBean.keyName}"/>
							                </p:column>
							                <p:outputLabel                         	
					                        	value="#{msg['catalogo.Label.Key']}"
					                        	for="pwdKey" />
					                        <p:inputText id="pwdKey" value="#{configuracionFacturacionBean.selected.passwordKey}"/>
				                    </p:panelGrid>
						        	</p:tab>
			                            	
			                	<p:tab id="contacto" title="Domicilio Fiscal">
			                    <p:panelGrid columns="2">
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Calle']}"
			                        	for="calle" />
			                        <p:inputText 
			                        	id="calle" 
			                        	value="#{configuracionFacturacionBean.selected.calle}" 
			                        	title="#{msg['catalogo.Label.Calle']}"
			                        	required="true"
			                       		requiredMessage="#{msg['catalogo.MsgRequiredCalle']}"/>
			
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.NumExt']}"
			                        	for="exterior" />
			                        <p:inputText 
			                        	id="exterior" 
			                        	value="#{configuracionFacturacionBean.selected.numext}" 
			                        	title="#{msg['catalogo.Label.NumExt']}"
			                        	required="true"
			                       		requiredMessage="#{msg['catalogo.MsgRequiredNumExt']}"/>
			
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.NumInt']}"
			                        	for="interior" />
			                        <p:inputText 
			                        	id="interior" 
			                        	value="#{configuracionFacturacionBean.selected.numint}" 
			                        	title="#{msg['catalogo.Label.NumInt']}"
			                        	required="false" />
			                        	
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Colonia']}" 
			                        	for="colonia" />
			                        <p:inputText 
			                        	id="colonia" 
			                        	value="#{configuracionFacturacionBean.selected.colonia}" 
			                        	title="#{msg['catalogo.Label.Colonia']}"
			                        	required="true" 
			                       		requiredMessage="#{msg['catalogo.MsgRequiredColonia']}"/>
			
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.CodigoPostal']}" 
			                        	for="cp" />
			                        <p:inputMask  
			                        	id="cp" 
			                        	value="#{configuracionFacturacionBean.selected.codigopostal}" 
			                        	title="#{msg['catalogo.Label.CodigoPostal']}"
			                        	required="true" 
			                       		requiredMessage="#{msg['catalogo.MsgRequiredCodigoPostal']}"
			                       		mask="99999" 
			                       		/>
			                        	
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Estado']}"
			                        	for="estado" />           	
						            <p:selectOneMenu 
						            	id="estado" 
					           			value="#{configuracionFacturacionBean.estadoSeleccionado}"
					           			required="true">
						                	<p:ajax listener="#{configuracionFacturacionBean.handleStateSelect}"  update="municipio" />
						                	<f:selectItem itemLabel="Selecciona un estado" itemValue="" noSelectionOption="true" />
						                	<f:selectItems
						                		value="#{estadoBean.estados}" 
								           		var="estadoseleccionado"
							           			itemLabel="#{estadoseleccionado.nombre}"
							           			itemValue="#{estadoseleccionado.nombre}"
						                	/>
						            </p:selectOneMenu>
			                       	            
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Municipio']}"
			                        	for="municipio" />
						            <p:selectOneMenu 
						            	id="municipio" 
					           			value="#{configuracionFacturacionBean.municipioSeleccionado}"
					           			required="true">
						                	<p:ajax listener="#{configuracionFacturacionBean.handleMunicipioSelect}"/>
						                	<f:selectItem itemLabel="Selecciona un municipio" itemValue="" noSelectionOption="true" />
						                	<f:selectItems
						                		value="#{configuracionFacturacionBean.municipios}" 
								           		var="municipioseleccionado"
							           			itemLabel="#{municipioseleccionado.nombre}"
							           			itemValue="#{municipioseleccionado.nombre}"
						                	/>
						            </p:selectOneMenu>
			                    	
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Telefono1']}"
			                        	for="telefono1" />
			                        <p:inputMask
			                        	id="telefono1" 
			                        	value="#{configuracionFacturacionBean.selected.telefono}" 
			                        	title="#{msg['catalogo.Label.Telefono1']}"
			                        	required="true" 
			                        	mask="(999)9999999"
			                        	/>
			
			
			                        <p:outputLabel
			                        	value="#{msg['catalogo.Label.Email']}"
			                        	for="correoelectronico" />
			                        <p:inputText 
			                        	id="correoelectronico" 
			                        	value="#{configuracionFacturacionBean.selected.correoelectronico}" 
			                        	title="#{msg['catalogo.Label.Email']}"
			                        	validatorMessage="#{msg['catalogo.MsgWrongFormat']}"
			                        	required="false">
			                        		  <f:validateRegex	pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />                        	
			                        </p:inputText>
			                        	
			                    </p:panelGrid>
					        	</p:tab>    
			    			</p:tabView>
	
		                    <p:commandButton 
		                    	action="#{configuracionFacturacionBean.create}" 
		                    	value="#{msg['catalogo.Button.Guardar']}" 
		                    	update="display,:growl" ajax="false">
		                    </p:commandButton>
		                </h:panelGroup>
		            </p:layoutUnit>               
	            </p:layout>
			</h:form>
        </ui:define>
    </ui:composition>

</html>